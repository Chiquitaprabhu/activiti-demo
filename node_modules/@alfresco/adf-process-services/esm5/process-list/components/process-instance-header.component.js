/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { AppConfigService, CardViewDateItemModel, CardViewTextItemModel, TranslationService } from '@alfresco/adf-core';
import { Component, Input } from '@angular/core';
import { ProcessInstance } from '../models/process-instance.model';
var ProcessInstanceHeaderComponent = /** @class */ (function () {
    function ProcessInstanceHeaderComponent(translationService, appConfig) {
        this.translationService = translationService;
        this.appConfig = appConfig;
        this.dateFormat = this.appConfig.get('dateValues.defaultDateFormat');
        this.dateLocale = this.appConfig.get('dateValues.defaultDateLocale');
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ProcessInstanceHeaderComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        this.refreshData();
    };
    /**
     * @return {?}
     */
    ProcessInstanceHeaderComponent.prototype.refreshData = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.processInstance) {
            /** @type {?} */
            var defaultProperties = this.initDefaultProperties();
            /** @type {?} */
            var filteredProperties_1 = this.appConfig.get('adf-process-instance-header.presets.properties');
            this.properties = defaultProperties.filter((/**
             * @param {?} cardItem
             * @return {?}
             */
            function (cardItem) { return _this.isValidSelection(filteredProperties_1, cardItem); }));
        }
    };
    /**
     * @private
     * @return {?}
     */
    ProcessInstanceHeaderComponent.prototype.initDefaultProperties = /**
     * @private
     * @return {?}
     */
    function () {
        return [
            new CardViewTextItemModel({
                label: 'ADF_PROCESS_LIST.PROPERTIES.STATUS',
                value: this.getProcessStatus(),
                key: 'status'
            }),
            new CardViewDateItemModel({
                label: 'ADF_PROCESS_LIST.PROPERTIES.END_DATE',
                value: this.processInstance.ended,
                format: this.dateFormat,
                locale: this.dateLocale,
                key: 'ended',
                default: this.translationService.instant('ADF_PROCESS_LIST.PROPERTIES.END_DATE_DEFAULT')
            }),
            new CardViewTextItemModel({
                label: 'ADF_PROCESS_LIST.PROPERTIES.CATEGORY',
                value: this.processInstance.processDefinitionCategory,
                key: 'category',
                default: this.translationService.instant('ADF_PROCESS_LIST.PROPERTIES.CATEGORY_DEFAULT')
            }),
            new CardViewTextItemModel({
                label: 'ADF_PROCESS_LIST.PROPERTIES.BUSINESS_KEY',
                value: this.processInstance.businessKey,
                key: 'businessKey',
                default: this.translationService.instant('ADF_PROCESS_LIST.PROPERTIES.BUSINESS_KEY_DEFAULT')
            }),
            new CardViewTextItemModel({
                label: 'ADF_PROCESS_LIST.PROPERTIES.CREATED_BY',
                value: this.getStartedByFullName(),
                key: 'assignee',
                default: this.translationService.instant('ADF_PROCESS_LIST.PROPERTIES.CREATED_BY_DEFAULT')
            }),
            new CardViewDateItemModel({
                label: 'ADF_PROCESS_LIST.PROPERTIES.CREATED',
                value: this.processInstance.started,
                format: this.dateFormat,
                locale: this.dateLocale,
                key: 'created'
            }),
            new CardViewTextItemModel({ label: 'ADF_PROCESS_LIST.PROPERTIES.ID',
                value: this.processInstance.id,
                key: 'id'
            }),
            new CardViewTextItemModel({ label: 'ADF_PROCESS_LIST.PROPERTIES.DESCRIPTION',
                value: this.processInstance.processDefinitionDescription,
                key: 'description',
                default: this.translationService.instant('ADF_PROCESS_LIST.PROPERTIES.DESCRIPTION_DEFAULT')
            })
        ];
    };
    /**
     * @private
     * @param {?} filteredProperties
     * @param {?} cardItem
     * @return {?}
     */
    ProcessInstanceHeaderComponent.prototype.isValidSelection = /**
     * @private
     * @param {?} filteredProperties
     * @param {?} cardItem
     * @return {?}
     */
    function (filteredProperties, cardItem) {
        return filteredProperties ? filteredProperties.indexOf(cardItem.key) >= 0 : true;
    };
    /**
     * @return {?}
     */
    ProcessInstanceHeaderComponent.prototype.getProcessStatus = /**
     * @return {?}
     */
    function () {
        if (this.processInstance) {
            return this.isRunning() ? 'Running' : 'Completed';
        }
    };
    /**
     * @return {?}
     */
    ProcessInstanceHeaderComponent.prototype.getStartedByFullName = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var fullName = '';
        if (this.processInstance && this.processInstance.startedBy) {
            fullName += this.processInstance.startedBy.firstName || '';
            fullName += fullName ? ' ' : '';
            fullName += this.processInstance.startedBy.lastName || '';
        }
        return fullName;
    };
    /**
     * @return {?}
     */
    ProcessInstanceHeaderComponent.prototype.isRunning = /**
     * @return {?}
     */
    function () {
        return this.processInstance && !this.processInstance.ended;
    };
    ProcessInstanceHeaderComponent.decorators = [
        { type: Component, args: [{
                    selector: 'adf-process-instance-header',
                    template: "<mat-card *ngIf=\"processInstance\" class=\"adf-card-container\">\n    <mat-card-content>\n        <adf-card-view [properties]=\"properties\"></adf-card-view>\n    </mat-card-content>\n</mat-card>\n",
                    styles: [":host{width:100%}.adf-card-container{font-family:inherit}"]
                }] }
    ];
    /** @nocollapse */
    ProcessInstanceHeaderComponent.ctorParameters = function () { return [
        { type: TranslationService },
        { type: AppConfigService }
    ]; };
    ProcessInstanceHeaderComponent.propDecorators = {
        processInstance: [{ type: Input }]
    };
    return ProcessInstanceHeaderComponent;
}());
export { ProcessInstanceHeaderComponent };
if (false) {
    /**
     * (**required**) Full details of the process instance to display information about.
     * @type {?}
     */
    ProcessInstanceHeaderComponent.prototype.processInstance;
    /** @type {?} */
    ProcessInstanceHeaderComponent.prototype.properties;
    /** @type {?} */
    ProcessInstanceHeaderComponent.prototype.dateFormat;
    /** @type {?} */
    ProcessInstanceHeaderComponent.prototype.dateLocale;
    /**
     * @type {?}
     * @private
     */
    ProcessInstanceHeaderComponent.prototype.translationService;
    /**
     * @type {?}
     * @private
     */
    ProcessInstanceHeaderComponent.prototype.appConfig;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvY2Vzcy1pbnN0YW5jZS1oZWFkZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGFsZnJlc2NvL2FkZi1wcm9jZXNzLXNlcnZpY2VzLyIsInNvdXJjZXMiOlsicHJvY2Vzcy1saXN0L2NvbXBvbmVudHMvcHJvY2Vzcy1pbnN0YW5jZS1oZWFkZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxxQkFBcUIsRUFBdUMscUJBQXFCLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUM3SixPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBNEIsTUFBTSxlQUFlLENBQUM7QUFDM0UsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBRW5FO0lBZUksd0NBQW9CLGtCQUFzQyxFQUN0QyxTQUEyQjtRQUQzQix1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW9CO1FBQ3RDLGNBQVMsR0FBVCxTQUFTLENBQWtCO1FBQzNDLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsOEJBQThCLENBQUMsQ0FBQztRQUNyRSxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLDhCQUE4QixDQUFDLENBQUM7SUFDekUsQ0FBQzs7Ozs7SUFFRCxvREFBVzs7OztJQUFYLFVBQVksT0FBc0I7UUFDOUIsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3ZCLENBQUM7Ozs7SUFFRCxvREFBVzs7O0lBQVg7UUFBQSxpQkFNQztRQUxHLElBQUksSUFBSSxDQUFDLGVBQWUsRUFBRTs7Z0JBQ2hCLGlCQUFpQixHQUFHLElBQUksQ0FBQyxxQkFBcUIsRUFBRTs7Z0JBQ2hELG9CQUFrQixHQUFhLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLGdEQUFnRCxDQUFD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QUNJLElBQUksSUFBSSxDQUFDLGVBQWUsRUFBRTtZQUN0QixPQUFPLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUM7U0FDckQ7SUFDTCxDQUFDOzs7O0lBRUQsNkRBQW9COzs7SUFBcEI7O1lBQ1EsUUFBUSxHQUFHLEVBQUU7UUFDakIsSUFBSSxJQUFJLENBQUMsZUFBZSxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsU0FBUyxFQUFFO1lBQ3hELFFBQVEsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxTQUFTLElBQUksRUFBRSxDQUFDO1lBQzNELFFBQVEsSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1lBQ2hDLFFBQVEsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxRQUFRLElBQUksRUFBRSxDQUFDO1NBQzdEO1FBQ0QsT0FBTyxRQUFRLENBQUM7SUFDcEIsQ0FBQzs7OztJQUVELGtEQUFTOzs7SUFBVDtRQUNJLE9BQU8sSUFBSSxDQUFDLGVBQWUsSUFBSSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDO0lBQy9ELENBQUM7O2dCQW5ISixTQUFTLFNBQUM7b0JBQ1AsUUFBUSxFQUFFLDZCQUE2QjtvQkFDdkMsa05BQXVEOztpQkFFMUQ7Ozs7Z0JBUjZHLGtCQUFrQjtnQkFBdkgsZ0JBQWdCOzs7a0NBWXBCLEtBQUs7O0lBNEdWLHFDQUFDO0NBQUEsQUFwSEQsSUFvSEM7U0EvR1ksOEJBQThCOzs7Ozs7SUFHdkMseURBQ2lDOztJQUVqQyxvREFBNEI7O0lBQzVCLG9EQUFtQjs7SUFDbkIsb0RBQW1COzs7OztJQUVQLDREQUE4Qzs7Ozs7SUFDOUMsbURBQW1DIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgQWxmcmVzY28gU29mdHdhcmUsIEx0ZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgQXBwQ29uZmlnU2VydmljZSwgQ2FyZFZpZXdEYXRlSXRlbU1vZGVsLCBDYXJkVmlld0l0ZW0sIENhcmRWaWV3QmFzZUl0ZW1Nb2RlbCwgQ2FyZFZpZXdUZXh0SXRlbU1vZGVsLCBUcmFuc2xhdGlvblNlcnZpY2UgfSBmcm9tICdAYWxmcmVzY28vYWRmLWNvcmUnO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBQcm9jZXNzSW5zdGFuY2UgfSBmcm9tICcuLi9tb2RlbHMvcHJvY2Vzcy1pbnN0YW5jZS5tb2RlbCc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnYWRmLXByb2Nlc3MtaW5zdGFuY2UtaGVhZGVyJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vcHJvY2Vzcy1pbnN0YW5jZS1oZWFkZXIuY29tcG9uZW50Lmh0bWwnLFxuICAgIHN0eWxlVXJsczogWycuL3Byb2Nlc3MtaW5zdGFuY2UtaGVhZGVyLmNvbXBvbmVudC5jc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBQcm9jZXNzSW5zdGFuY2VIZWFkZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkNoYW5nZXMge1xuXG4gICAgLyoqICgqKnJlcXVpcmVkKiopIEZ1bGwgZGV0YWlscyBvZiB0aGUgcHJvY2VzcyBpbnN0YW5jZSB0byBkaXNwbGF5IGluZm9ybWF0aW9uIGFib3V0LiAqL1xuICAgIEBJbnB1dCgpXG4gICAgcHJvY2Vzc0luc3RhbmNlOiBQcm9jZXNzSW5zdGFuY2U7XG5cbiAgICBwcm9wZXJ0aWVzOiBDYXJkVmlld0l0ZW0gW107XG4gICAgZGF0ZUZvcm1hdDogc3RyaW5nO1xuICAgIGRhdGVMb2NhbGU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdHJhbnNsYXRpb25TZXJ2aWNlOiBUcmFuc2xhdGlvblNlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBhcHBDb25maWc6IEFwcENvbmZpZ1NlcnZpY2UpIHtcbiAgICAgICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5hcHBDb25maWcuZ2V0KCdkYXRlVmFsdWVzLmRlZmF1bHREYXRlRm9ybWF0Jyk7XG4gICAgICAgIHRoaXMuZGF0ZUxvY2FsZSA9IHRoaXMuYXBwQ29uZmlnLmdldCgnZGF0ZVZhbHVlcy5kZWZhdWx0RGF0ZUxvY2FsZScpO1xuICAgIH1cblxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICAgICAgdGhpcy5yZWZyZXNoRGF0YSgpO1xuICAgIH1cblxuICAgIHJlZnJlc2hEYXRhKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5wcm9jZXNzSW5zdGFuY2UpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRQcm9wZXJ0aWVzID0gdGhpcy5pbml0RGVmYXVsdFByb3BlcnRpZXMoKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbHRlcmVkUHJvcGVydGllczogc3RyaW5nW10gPSB0aGlzLmFwcENvbmZpZy5nZXQoJ2FkZi1wcm9jZXNzLWluc3RhbmNlLWhlYWRlci5wcmVzZXRzLnByb3BlcnRpZXMnKTtcbiAgICAgICAgICAgIHRoaXMucHJvcGVydGllcyA9IGRlZmF1bHRQcm9wZXJ0aWVzLmZpbHRlcigoY2FyZEl0ZW0pID0+IHRoaXMuaXNWYWxpZFNlbGVjdGlvbihmaWx0ZXJlZFByb3BlcnRpZXMsIGNhcmRJdGVtKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGluaXREZWZhdWx0UHJvcGVydGllcygpOiBhbnlbXSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBuZXcgQ2FyZFZpZXdUZXh0SXRlbU1vZGVsKFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfUFJPQ0VTU19MSVNULlBST1BFUlRJRVMuU1RBVFVTJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuZ2V0UHJvY2Vzc1N0YXR1cygpLFxuICAgICAgICAgICAgICAgICAgICBrZXk6ICdzdGF0dXMnXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgQ2FyZFZpZXdEYXRlSXRlbU1vZGVsKFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfUFJPQ0VTU19MSVNULlBST1BFUlRJRVMuRU5EX0RBVEUnLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5wcm9jZXNzSW5zdGFuY2UuZW5kZWQsXG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdDogdGhpcy5kYXRlRm9ybWF0LFxuICAgICAgICAgICAgICAgICAgICBsb2NhbGU6IHRoaXMuZGF0ZUxvY2FsZSxcbiAgICAgICAgICAgICAgICAgICAga2V5OiAnZW5kZWQnLFxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiB0aGlzLnRyYW5zbGF0aW9uU2VydmljZS5pbnN0YW50KCdBREZfUFJPQ0VTU19MSVNULlBST1BFUlRJRVMuRU5EX0RBVEVfREVGQVVMVCcpXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgQ2FyZFZpZXdUZXh0SXRlbU1vZGVsKFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfUFJPQ0VTU19MSVNULlBST1BFUlRJRVMuQ0FURUdPUlknLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5wcm9jZXNzSW5zdGFuY2UucHJvY2Vzc0RlZmluaXRpb25DYXRlZ29yeSxcbiAgICAgICAgICAgICAgICAgICAga2V5OiAnY2F0ZWdvcnknLFxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiB0aGlzLnRyYW5zbGF0aW9uU2VydmljZS5pbnN0YW50KCdBREZfUFJPQ0VTU19MSVNULlBST1BFUlRJRVMuQ0FURUdPUllfREVGQVVMVCcpXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgQ2FyZFZpZXdUZXh0SXRlbU1vZGVsKFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfUFJPQ0VTU19MSVNULlBST1BFUlRJRVMuQlVTSU5FU1NfS0VZJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMucHJvY2Vzc0luc3RhbmNlLmJ1c2luZXNzS2V5LFxuICAgICAgICAgICAgICAgICAgICBrZXk6ICdidXNpbmVzc0tleScsXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHRoaXMudHJhbnNsYXRpb25TZXJ2aWNlLmluc3RhbnQoJ0FERl9QUk9DRVNTX0xJU1QuUFJPUEVSVElFUy5CVVNJTkVTU19LRVlfREVGQVVMVCcpXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgQ2FyZFZpZXdUZXh0SXRlbU1vZGVsKFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfUFJPQ0VTU19MSVNULlBST1BFUlRJRVMuQ1JFQVRFRF9CWScsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLmdldFN0YXJ0ZWRCeUZ1bGxOYW1lKCksXG4gICAgICAgICAgICAgICAgICAgIGtleTogJ2Fzc2lnbmVlJyxcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogdGhpcy50cmFuc2xhdGlvblNlcnZpY2UuaW5zdGFudCgnQURGX1BST0NFU1NfTElTVC5QUk9QRVJUSUVTLkNSRUFURURfQllfREVGQVVMVCcpXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgQ2FyZFZpZXdEYXRlSXRlbU1vZGVsKFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfUFJPQ0VTU19MSVNULlBST1BFUlRJRVMuQ1JFQVRFRCcsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnByb2Nlc3NJbnN0YW5jZS5zdGFydGVkLFxuICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IHRoaXMuZGF0ZUZvcm1hdCxcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxlOiB0aGlzLmRhdGVMb2NhbGUsXG4gICAgICAgICAgICAgICAgICAgIGtleTogJ2NyZWF0ZWQnXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgQ2FyZFZpZXdUZXh0SXRlbU1vZGVsKFxuICAgICAgICAgICAgICAgIHtsYWJlbDogJ0FERl9QUk9DRVNTX0xJU1QuUFJPUEVSVElFUy5JRCcsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMucHJvY2Vzc0luc3RhbmNlLmlkLFxuICAgICAgICAgICAgICAgIGtleTogJ2lkJ1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgQ2FyZFZpZXdUZXh0SXRlbU1vZGVsKFxuICAgICAgICAgICAgICAgIHtsYWJlbDogJ0FERl9QUk9DRVNTX0xJU1QuUFJPUEVSVElFUy5ERVNDUklQVElPTicsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMucHJvY2Vzc0luc3RhbmNlLnByb2Nlc3NEZWZpbml0aW9uRGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAga2V5OiAnZGVzY3JpcHRpb24nLFxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHRoaXMudHJhbnNsYXRpb25TZXJ2aWNlLmluc3RhbnQoJ0FERl9QUk9DRVNTX0xJU1QuUFJPUEVSVElFUy5ERVNDUklQVElPTl9ERUZBVUxUJylcbiAgICAgICAgICAgIH0pXG4gICAgICAgIF07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc1ZhbGlkU2VsZWN0aW9uKGZpbHRlcmVkUHJvcGVydGllczogc3RyaW5nW10sIGNhcmRJdGVtOiBDYXJkVmlld0Jhc2VJdGVtTW9kZWwpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIGZpbHRlcmVkUHJvcGVydGllcyA/IGZpbHRlcmVkUHJvcGVydGllcy5pbmRleE9mKGNhcmRJdGVtLmtleSkgPj0gMCA6IHRydWU7XG4gICAgfVxuXG4gICAgZ2V0UHJvY2Vzc1N0YXR1cygpOiBzdHJpbmcge1xuICAgICAgICBpZiAodGhpcy5wcm9jZXNzSW5zdGFuY2UpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlzUnVubmluZygpID8gJ1J1bm5pbmcnIDogJ0NvbXBsZXRlZCc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRTdGFydGVkQnlGdWxsTmFtZSgpOiBzdHJpbmcge1xuICAgICAgICBsZXQgZnVsbE5hbWUgPSAnJztcbiAgICAgICAgaWYgKHRoaXMucHJvY2Vzc0luc3RhbmNlICYmIHRoaXMucHJvY2Vzc0luc3RhbmNlLnN0YXJ0ZWRCeSkge1xuICAgICAgICAgICAgZnVsbE5hbWUgKz0gdGhpcy5wcm9jZXNzSW5zdGFuY2Uuc3RhcnRlZEJ5LmZpcnN0TmFtZSB8fCAnJztcbiAgICAgICAgICAgIGZ1bGxOYW1lICs9IGZ1bGxOYW1lID8gJyAnIDogJyc7XG4gICAgICAgICAgICBmdWxsTmFtZSArPSB0aGlzLnByb2Nlc3NJbnN0YW5jZS5zdGFydGVkQnkubGFzdE5hbWUgfHwgJyc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZ1bGxOYW1lO1xuICAgIH1cblxuICAgIGlzUnVubmluZygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvY2Vzc0luc3RhbmNlICYmICF0aGlzLnByb2Nlc3NJbnN0YW5jZS5lbmRlZDtcbiAgICB9XG59XG4iXX0=